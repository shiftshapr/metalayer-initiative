<!DOCTYPE html>
<html>
<head>
    <title>WebSocket Connection Test</title>
</head>
<body>
    <h1>WebSocket Connection Test</h1>
    <div id="status">Testing...</div>
    <div id="logs"></div>

    <script>
        const statusDiv = document.getElementById('status');
        const logsDiv = document.getElementById('logs');
        
        function log(message) {
            console.log(message);
            logsDiv.innerHTML += '<div>' + message + '</div>';
        }
        
        log('üß™ Testing WebSocket connection from browser...');
        
        // Test WebSocket connection
        const wsUrl = 'ws://216.238.91.120:3004?userId=test123&userEmail=test@example.com';
        log('üîå Connecting to: ' + wsUrl);
        
        const ws = new WebSocket(wsUrl);
        
        ws.onopen = () => {
            log('‚úÖ WebSocket connection successful!');
            statusDiv.innerHTML = '‚úÖ WebSocket connection successful!';
            statusDiv.style.color = 'green';
            
            // Send a test message
            ws.send(JSON.stringify({
                type: 'TEST_MESSAGE',
                content: 'Hello from browser test'
            }));
        };
        
        ws.onmessage = (event) => {
            log('üì® Received: ' + event.data);
        };
        
        ws.onerror = (error) => {
            log('‚ùå WebSocket error: ' + error);
            statusDiv.innerHTML = '‚ùå WebSocket connection failed!';
            statusDiv.style.color = 'red';
        };
        
        ws.onclose = (event) => {
            log('üîå WebSocket closed: ' + event.code + ' ' + event.reason);
        };
        
        // Timeout after 10 seconds
        setTimeout(() => {
            if (ws.readyState !== WebSocket.OPEN) {
                log('‚è∞ Connection timeout');
                statusDiv.innerHTML = '‚è∞ Connection timeout';
                statusDiv.style.color = 'orange';
            }
        }, 10000);
    </script>
</body>
</html>